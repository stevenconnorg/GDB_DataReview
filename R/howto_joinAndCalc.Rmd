---
title: "How to use Join and Calculate Fields Tool"
author: "Air Force Civic Engineering Center (AFCEC)"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
---



```{r knitr_options, echo=FALSE,message=FALSE,error=FALSE,warning=FALSE}
library(knitr)
library(rmarkdown)
options(knitr.table.format = "latex")
```

# Overview
The ArcGIS Python Script Tool "Join Fields and Calculate" may be used to update the destination values in a target feature layer field with the values in another table's fields using a common key (join). This script will perform similarly as if you joined a table to a feature class to calculate a certain field based on another field in the joined table.

# Parameters
The tool has 8 parameters:  
1. **Transfer_From (data type: Table View)** - Which table are do you want to transfer data from? This parameter must be the path to a table(e.g.: Comma-separated Values (.csv) file, Excel Workbook (.xlsx) Sheet, Esri geodatabase table, etc.). This table will act as 'source' data.

2. **Using_Join_Field  (data type: Field)** - From the source table, which field should be used to joinwith another feature class' attributes? This will provide the 'key' to transfer data from the source table to the target table.

3. **Source_Field (data type: Field)** - From the source table, which field's data do you want to transfer to the target table? This field's data will be updated in the target feature class that have matching fields.  

4. **Destination_Feature (data type: Feature Layer or Feature Class)** - Which feature class do you want to transfer data to? This parameter must be the path to a Esri Feature Class or Feature Layer. This table will act as 'target' data source.  

5. **Destination_Join_Field (data type: Field)** - From the target table, which field should be used to joinwith another feature class' attributes? This will provide the 'key' to transfer data from the source table to the target table.  

6. **Destination_Field (data type: Field)** - From the target table, which field's data do you want to transfer from the source table? This field's data will be updated from the source table that have matching fields using the join fields provided.  
  
7. **Where_Clause (data type: String)** - How should the source values be filtered? Default is "IS NOT NULL", otherwise you will overwrite the target features will null values.  

8. **Remove_Leading_Zeros (data type: Boolean)** - Do you want to remove leading zeros from the Source Join Field prior to 'joining' the tables?


\pagebreak


# How to Use

## Begin by opening the toolbox  

Navigate to the location of the script tool, then right-click the 'Join Fields and Calculate' script tool to open (Fig. 1).

![Open the Python script tool](C:\\Users\\stevenconnorg\\Documents\\knight-federal-solutions\\CIP_DataReview\\tutorial-images\\joinCalc-open_tool.jpg)

\pagebreak


## Fill out the parameters 
Next, fill out the parameters for the tool. Here, we want to transfer the RPUID attributes (source field) from the 'RPSUID_and_RPUID.csv' table (transfer from) using the 'FacilityNumber' join field (Using_Join_Field) to the Building_A feature layer's (Destinate Feature) 'realPropertyUniqueID' field (Destination_Field) using the 'buildingNumber' field (Destination_Join_Field) (Fig. 2). 

We also keep the default value in the 'Where Clause' parameter of 'IS NOT NULL,' in order to transfer RPUID from the source table where RPUIDs are not null, **otherwise you may overwrite the target features will null values**  (Fig. 2). 

We noticed that the 'buildingNumber' field has some leading zeros that we want to remove the beginning of the values, so we click the "Remove Leading Zeros" toggle (Fig. 2).

You may also get more information for the tool and each tool parameter by clicking the 'Tool Help' button at the bottom of the tool dialog box.  
Alternatively, you may also run this tool in 'batch' for multiple features in a geodatabase or geodatabases (Fig. 3).

![Tool Parameters](C:\\Users\\stevenconnorg\\Documents\\knight-federal-solutions\\CIP_DataReview\\tutorial-images\\joinCalc-tool_params.jpg)

![Tool Parameters](C:\\Users\\stevenconnorg\\Documents\\knight-federal-solutions\\CIP_DataReview\\tutorial-images\\joinCalc-batch.jpg)



\pagebreak

## View the update results  

Open the destinate Feature Class and view the update destination field values.



Before                     |  After
:-------------------------:|:-------------------------:
![realPropertyUniqueIDs in Building_A Feature - Before ](C:\\Users\\stevenconnorg\\Documents\\knight-federal-solutions\\CIP_DataReview\\tutorial-images\\joinCalc-before.jpg)  |  ![realPropertyUniqueIDs in Building_A Feature - After](C:\\Users\\stevenconnorg\\Documents\\knight-federal-solutions\\CIP_DataReview\\tutorial-images\\joinCalc-results.jpg)


\pagebreak




# Production Info
For posterity, development information used to compile this report is listed below.


```{r,cache=FALSE,eval=TRUE, echo=FALSE,error=FALSE,warning=FALSE}
sessionInfo()

# Further, this packrat project bundle may be found at https://github.com/stevenconnorg/AF_Installation_Feedback/tree/master/packrat/bundles for R package sources


# R version 3.4.1 (2017-06-30)
# Platform: x86_64-w64-mingw32/x64 (64-bit)
# Running under: Windows >= 8 x64 (build 9200)
# 
# Matrix products: default
# 
# locale:
# [1] LC_COLLATE=English_United States.1252 
# [2] LC_CTYPE=English_United States.1252   
# [3] LC_MONETARY=English_United States.1252
# [4] LC_NUMERIC=C                          
# [5] LC_TIME=English_United States.1252    
# 
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base     
# 
# other attached packages:
#  [1] bookdown_0.7    rmarkdown_1.9   knitr_1.20      tinytex_0.5    
#  [5] devtools_1.13.4 backports_1.1.2 digest_0.6.15   anchors_3.0-8  
#  [9] MASS_7.3-49     rgenoud_5.8-1.0 bibtex_0.4.2    purrr_0.2.4    
# [13] Rcpp_0.12.16    ggmap_2.6.1     sf_0.6-1        markdown_0.8   
# [17] stringr_1.3.0   DT_0.4          leaflet_1.1.0   dplyr_0.7.4    
# [21] ggplot2_2.2.1   rprojroot_1.3-2 packrat_0.4.9-1
# 
# loaded via a namespace (and not attached):
#  [1] xfun_0.1          reshape2_1.4.3    lattice_0.20-35  
#  [4] colorspace_1.3-2  htmltools_0.3.6   yaml_2.1.18      
#  [7] rlang_0.2.0       e1071_1.6-8       pillar_1.2.1     
# [10] withr_2.1.2       glue_1.2.0        DBI_0.8          
# [13] sp_1.2-7          bindrcpp_0.2.2    jpeg_0.1-8       
# [16] bindr_0.1.1       plyr_1.8.4        munsell_0.4.3    
# [19] gtable_0.2.0      htmlwidgets_1.0   RgoogleMaps_1.4.1
# [22] mapproj_1.2.6     evaluate_0.10.1   memoise_1.1.0    
# [25] httpuv_1.3.6.2    crosstalk_1.0.0   class_7.3-14     
# [28] proto_1.0.0       xtable_1.8-2      geosphere_1.5-7  
# [31] udunits2_0.13     scales_0.5.0      classInt_0.1-24  
# [34] mime_0.5          rjson_0.2.15      png_0.1-7        
# [37] stringi_1.1.7     shiny_1.0.5       grid_3.4.1       
# [40] tools_3.4.1       magrittr_1.5      maps_3.3.0       
# [43] lazyeval_0.2.1    tibble_1.4.2      pkgconfig_2.0.1  
# [46] assertthat_0.2.0  R6_2.2.2          units_0.5-1      
# [49] compiler_3.4.1   
```

